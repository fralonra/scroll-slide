!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t=t||self).Scroll=i()}(this,function(){"use strict";const t=1e3,i="scroll-slide";function e(i){return i.match(/^\d+$/)?`${i}ms`:`${t}ms`}function o(t,i,e){const o=[];return t.forEach((t,s,n)=>{s===i&&o.push(e),o.push(t)}),i===t.length&&o.push(e),o}function s(t,i,e=null){const o=i.hasChildNodes()?i.childNodes:[];return null===e||e===o.length?i.appendChild(t):i.insertBefore(t,o[e])}function n(t){return Number(t.split(/[^\d-]+/)[0])}return class{constructor(t={}){this._initOption(t),this._initView(),this._initGlobalEvent()}add(t,i=-1){const e=this,s=e._option.slides;if((i<0||i>s.length)&&(i=s.length),e._initSlide(t,i),e._option.slides=o(e._option.slides,i,t),i<=e._currentSlide){const t=e._prevSlidesHeight(++e._currentSlide);e._wrapper.style.top=`${-t}px`}"none"!==e._option.paginator&&(e._addDot(i),i<=e._currentSlide&&e._changePaginator(e._currentSlide-1,e._currentSlide))}current(){return this._currentSlide}remove(t){t>=this._option.slides.length-1||(t===this._currentSlide&&t===this._option.slides.length-1&&this.scrollTo(0),t<this._currentSlide&&this.scrollTo(this._currentSlide-1),"none"!==this._option.paginator&&(this._removeDot(t),t<=this._currentSlide&&this._changePaginator(this._currentSlide-1,this._currentSlide)),this._wrapper.removeChild(this._option.slides[t]),this._option.slides=this._option.slides.filter((i,e,o)=>e!==t))}scrollDown(){const t=this,i=t._option.slides;if(t._isLastSlide()&&!t._option.loop)return;const e=t._isLastSlide()?0:t._currentSlide+1,o=t._isSlideMutiPages(t._currentSlide),s=n(t._wrapper.style.top),r=o?i[t._currentSlide].clientHeight-t._scrollInSlide>t._option.viewport.clientHeight?t._option.viewport.clientHeight:i[t._currentSlide].clientHeight-t._scrollInSlide:i[t._currentSlide].clientHeight,l=o&&t._scrollInSlide+r===i[t._currentSlide].clientHeight;t._wrapper.style.top=t._isLastSlide()&&!o||t._isLastSlide()&&l?"0px":`${s-r}px`,!o||l?(t._changePaginator(t._currentSlide,e),t._setCurrentSlide(e),0!==t._scrollInSlide&&(t._scrollInSlide=0)):o&&(t._scrollInSlide+=r)}scrollTo(t=0){const i=this._option.slides.length-1;t<0?t=i:t>i&&(t=0);const e=0===t?0:this._prevSlidesHeight(t);this._wrapper.style.top=`${-e}px`,this._currentSlide!==t&&this._changePaginator(this._currentSlide,t);const o=t!==this._currentSlide;this._setCurrentSlide(t,o),0!==this._scrollInSlide&&(this._scrollInSlide=0)}scrollUp(){const t=this;if(t._isFirstSlide()&&!t._option.loop)return;const i=t._option.slides,e=t._isFirstSlide()?i.length-1:t._currentSlide-1,o=n(t._wrapper.style.top);t._wrapper.style.top=t._isFirstSlide()?`${i[i.length-1].clientHeight-t._wrapper.clientHeight}px`:0===t._scrollInSlide?`${o+i[e].clientHeight}px`:`${o+t._scrollInSlide}px`,0===t._scrollInSlide?(t._changePaginator(t._currentSlide,e),t._setCurrentSlide(e)):t._scrollInSlide=0}toggleFull(t){"true"===t.getAttribute("data-full")?(t.removeAttribute("data-full"),t.style.height=""):(t.setAttribute("data-full","true"),t.style.height=`${this._option.viewport.clientHeight}px`)}_changePaginator(t,e){const o=this;"none"!==o._option.paginator&&o._dotList.forEach((s,n,r)=>{e===n?(s.classList.add(`${i}-paginator-dot-active`),s.style.background=o._option.dotActiveColor):t===n&&(s.classList.remove(`${i}-paginator-dot-active`),s.style.background=o._option.dotColor)})}_addDot(t=0){this._initDot(t),this._dotList.forEach((i,e,o)=>{e>t&&i.setAttribute("index",Number(i.getAttribute("index"))+1)}),this._initPaginatorTop()}_removeDot(t=0){const i=this._dotList[t];this._paginator.removeChild(i),this._dotList.forEach((i,e,o)=>{e>t&&i.setAttribute("index",e-1)}),this._dotList.splice(t,1),this._initPaginatorTop()}_initOption(i={}){const e={autoHeight:!0,duration:t,dotColor:"#e1e1e1",dotActiveColor:"#6687ff",idleTime:200,loop:!0,keyboard:!0,paginator:"none",slides:[],viewport:null,onScroll:null};this._currentSlide=0,this._doc=window.document,this._dotList=null,this._isTouching=!1,this._lastAniTime=0,this._paginator=null,this._scrollInSlide=0,this._touchStartY=0,this._wrapper=null,this._option={},Object.keys(e).forEach(t=>{i.hasOwnProperty(t)?this._option[t]=i[t]:this._option[t]=e[t]}),this._duration=this._option.duration}_initDot(t=0){const e=this._doc.createElement("div");e.setAttribute("index",t),e.classList.add(`${i}-paginator-dot`),e.style.width="0.75rem",e.style.height="0.75rem",e.style.background=this._option.dotColor,e.style.margin="0.5rem auto",e.style.borderRadius="50%",e.style.transition="all 0.5s ease 0s",e.style.cursor="pointer",t===this._currentSlide&&(e.classList.add(`${i}-paginator-dot-active`),e.style.background=this._option.dotActiveColor),e.addEventListener("click",t=>{this._handleDotClick(t)}),this._dotList=o(this._dotList,t,e),s(e,this._paginator,t)}_initDotList(){this._dotList=[],this._option.slides.forEach((t,i,e)=>{this._initDot(i)})}_initFullHeight(t){t.style.height=`${this._option.viewport.clientHeight}px`}_initGlobalEvent(){const t=this;t._option.autoHeight&&window.addEventListener("resize",i=>{t._handleResize(i),t._wrapper.style.transitionDuration="0s",t.scrollTo(t._currentSlide),setTimeout(()=>{t._wrapper.style.transitionDuration=e(String(t._duration))},1)}),t._option.keyboard&&t._doc.addEventListener("keydown",i=>{t._handleKeyboard(i)})}_initPaginator(t=this._option.paginator){const e=this._paginator;e.classList.add(`${i}-paginator`),e.style.position="absolute",e.style[t]=`${.05*this._wrapper.clientWidth}px`,this._initDotList(),this._option.viewport.appendChild(e),e.style.top="50%",this._initPaginatorTop()}_initPaginatorTop(){const t=this._paginator.clientHeight/2;this._paginator.style.marginTop=`${-t}px`}_initSlide(t,e=null){t.classList.add(`${i}-slide`),t.style.overflow="hidden","true"===t.getAttribute("data-full")&&this._initFullHeight(t),s(t,this._wrapper,e)}_initSlides(){this._option.slides=[].slice.call(this._option.slides),this._option.slides.forEach(t=>{this._initSlide(t)}),s(this._wrapper,this._option.viewport)}_isFirstSlide(){return 0===this._currentSlide}_isLastSlide(){return this._currentSlide===this._option.slides.length-1}_isSlideOnTop(){return n(this._wrapper.style.top)===this._prevSlidesHeight()}_isSlideMutiPages(t){return this._option.slides[t].clientHeight>this._option.viewport.clientHeight}_initView(){const t=this;let o=t._option.viewport;null===o&&(o=t._doc.getElementByTagName("body")[0]),o.classList.add(`${i}-viewport`),o.style.position="relative",""===o.style.height&&(o.style.height="100%"),o.style.overflow="hidden",o.addEventListener("DOMMouseScroll",i=>{t._handleMouseWheel(i)}),o.addEventListener("mousewheel",i=>{t._handleMouseWheel(i)}),o.addEventListener("touchstart",i=>{t._handleTouchStart(i)}),t._wrapper=t._doc.createElement("div"),t._wrapper.classList.add(`${i}-wrapper`),t._wrapper.style.position="relative",t._wrapper.style.top="0px";const s=e(String(t._duration));t._wrapper.style.transition=`all ${s} ease 0s`,t._initSlides(),"none"!==t._option.paginator&&"left"!==t._option.paginator&&"right"!==t._option.paginator&&(t._option.paginator="none"),"none"!==t._option.paginator&&(o.style.position="relative",t._paginator=this._doc.createElement("div"),t._initPaginator())}_prevSlidesHeight(t=this._currentSlide){let i=0;return this._option.slides.forEach((e,o,s)=>{t<=o||(i+=e.clientHeight)}),i}_setCurrentSlide(t,i=!0){this._currentSlide=t,i&&"function"==typeof this._option.onScroll&&this._option.onScroll(this._currentSlide)}_handleDotClick(t){t.preventDefault();const i=Number(t.target.getAttribute("index"))||0;i!==this._currentSlide&&this.scrollTo(i)}_handleKeyboard(t){switch(t.key){case"ArrowDown":case"PageDown":this.scrollDown();break;case"ArrowUp":case"PageUp":this.scrollUp()}}_handleMouseWheel(t){t.preventDefault();const i=this,e=(new Date).getTime();e-i._lastAniTime<i._option.idleTime+i._duration||((t.wheelDelta||-t.detail)<0?i.scrollDown():i.scrollUp(),i._lastAniTime=e)}_handleResize(t){this._initSlides()}_handleTouchMove(t){t.preventDefault();const i=this;if(!i._isTouching)return;const e=(new Date).getTime();if(!(e-i._lastAniTime<i._option.idleTime+i._duration)){if(t.touches&&t.touches.length){const o=i._touchStartY-t.touches[0].pageY;if(Math.abs(o)<50)return;o<0?i.scrollDown():i.scrollUp(),t.target.removeEventListener("touchmove",i._handleTouchMove),i._lastAniTime=e}i._touchStartY=0,i._isTouching=!1}}_handleTouchStart(t){const i=this;t.touches&&t.touches.length&&(i._isTouching=!0,i._touchStartY=t.touches[0].pageY,i._option.viewport.addEventListener("touchmove",t=>{i._handleTouchMove(t)}))}}});
